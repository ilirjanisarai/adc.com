<!DOCTYPE html>
<html lang="sq">
<head>
  <meta charset="UTF-8">
  <title>ADC - Kalkulator Sigurimi (Vlera e deklaruar nga klienti)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --adc-red: #e30613;
      --adc-dark: #1f1f1f;
      --adc-light: #f5f5f5;
      --adc-border: #dddddd;
    }

    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    body {
      margin: 0;
      background: var(--adc-light);
      color: #333;
    }

    .page-wrap {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .card {
      background: #fff;
      max-width: 960px; /* më e gjerë */
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      padding: 24px;
    }

    .card-header {
      border-bottom: 1px solid var(--adc-border);
      padding-bottom: 10px;
      margin-bottom: 18px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
    }

    .card-header h1 {
      margin: 0;
      font-size: 1.2rem;
      color: var(--adc-dark);
    }

    .tag {
      font-size: 0.8rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--adc-red);
      color: var(--adc-red);
      background: #fff5f5;
    }

    h2 {
      font-size: 1rem;
      margin: 0 0 12px;
      color: var(--adc-dark);
    }

    .form-group {
      margin-bottom: 14px;
    }

    label {
      display: block;
      font-size: 0.9rem;
      margin-bottom: 4px;
      font-weight: 500;
    }

    select,
    input[type="number"],
    input[type="text"] {
      width: 100%;
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid var(--adc-border);
      font-size: 0.95rem;
    }

    select:focus,
    input:focus {
      outline: none;
      border-color: var(--adc-red);
      box-shadow: 0 0 0 1px rgba(227, 6, 19, 0.15);
    }

    .help-text {
      font-size: 0.78rem;
      color: #777;
      margin-top: 3px;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2fr);
      gap: 24px;
    }

    @media (max-width: 768px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    .results-card {
      border-radius: 10px;
      border: 1px solid var(--adc-border);
      padding: 14px 16px;
      background: #fafafa;
    }

    .result-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
    }

    .result-row span.label {
      font-size: 0.88rem;
      color: #555;
    }

    .result-row span.value {
      font-weight: 600;
      font-size: 0.95rem;
    }

    .result-row.total {
      border-top: 1px dashed #ccc;
      padding-top: 8px;
      margin-top: 8px;
    }

    .result-row.total span.label {
      font-weight: 600;
    }

    .result-row.premium {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--adc-red);
    }

    .result-row.premium span.label {
      color: var(--adc-red);
      font-size: 0.95rem;
    }

    .result-row.premium span.value {
      color: var(--adc-red);
      font-size: 1.1rem;
    }

    .discount-title {
      margin-top: 8px;
      font-size: 0.85rem;
      font-weight: 600;
      color: #444;
    }

    .rate-note {
      font-size: 0.78rem;
      color: #666;
      margin-top: 6px;
      line-height: 1.4;
    }

    .pill {
      display: inline-block;
      background: #fff;
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 0.75rem;
      border: 1px solid #eee;
      margin-left: 4px;
    }

    .footer-note {
      margin-top: 14px;
      font-size: 0.8rem;
      color: #777;
    }
  </style>
</head>
<body>
<div class="page-wrap">
  <div class="card">
    <div class="card-header">
      <h1>Kalkulator Sigurimi – Vlera e deklaruar nga klienti</h1>
      <span class="tag">Zjarri &amp; tërmeti të përfshira në normë</span>
    </div>

    <div class="layout">
      <!-- Forma -->
      <div>
        <h2>Të dhënat e pronës</h2>

        <div class="form-group">
          <label for="propertyType">Lloji i pronës</label>
          <select id="propertyType">
            <option value="apartament">Apartament</option>
            <option value="vile">Vilë</option>
          </select>
          <div class="help-text" id="typeHelp">
            Apartament – vlera totale deklarohet nga klienti.<br>
            Vilë – vlera e strukturës llogaritet me koston 90 000 lek/m².
          </div>
        </div>

        <div class="form-group" id="propertyValueGroup">
          <label for="propertyValue">Vlera e apartamentit (lek)</label>
          <input type="text" id="propertyValue" placeholder="p.sh. 12,000,000">
          <div class="help-text">
            Vlera totale e apartamentit sipas deklarimit të klientit.
          </div>
        </div>

        <div class="form-group">
          <label for="surface">Sipërfaqja e pronës (m²)</label>
          <input type="number" id="surface" min="0" step="0.01" placeholder="p.sh. 82">
          <div class="help-text" id="surfaceHelp">
            Përdoret për të llogaritur çmimin për m² dhe vlerën e vilës (90 000 lek/m²).
          </div>
        </div>

        <div class="form-group">
          <label for="contentsValue">Vlera e mobilimit &amp; pajisjeve (lek)</label>
          <input type="text" id="contentsValue" placeholder="p.sh. 1,200,000">
          <div class="help-text">
            Mobilim, elektroshtepiake dhe pajisje të tjera brenda pronës.
          </div>
        </div>
      </div>

      <!-- Rezultatet -->
      <div>
        <h2>Rezultati i llogaritjes</h2>

        <div class="results-card">
          <div class="result-row">
            <span class="label">Vlera e strukturës (lek)</span>
            <span class="value" id="structureValueDisplay">-</span>
          </div>
          <div class="result-row">
            <span class="label">Vlera e mobilimit (lek)</span>
            <span class="value" id="contentsValueDisplay">-</span>
          </div>
          <div class="result-row">
            <span class="label">Sipërfaqja (m²)</span>
            <span class="value" id="surfaceDisplay">-</span>
          </div>
          <div class="result-row">
            <span class="label">Çmimi për m² (lek)</span>
            <span class="value" id="pricePerM2Display">-</span>
          </div>
          <div class="result-row total">
            <span class="label">Vlera totale e siguruar (lek)</span>
            <span class="value" id="totalValueDisplay">-</span>
          </div>
          <div class="result-row premium">
            <span class="label">Prima vjetore</span>
            <span class="value" id="premiumDisplay">-</span>
          </div>

          <div class="discount-title">Prima me zbritje</div>
          <div class="result-row">
            <span class="label">Prima me 20% zbritje</span>
            <span class="value" id="premium20Display">-</span>
          </div>
          <div class="result-row">
            <span class="label">Prima me 30% zbritje</span>
            <span class="value" id="premium30Display">-</span>
          </div>

          <div class="rate-note">
            Prima bazë llogaritet si <strong>Prima × vlera totale e siguruar</strong>,
            më pas aplikohet zbritja përkatëse.
            <span class="pill">zjarr</span>
            <span class="pill">tërmet</span>
            <span class="pill">rreziqe të tjera</span>
          </div>
        </div>

        <div class="footer-note">
          Për vilat, vlera e strukturës llogaritet me koston e ndërtimit 90 000 lek/m².
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  const PREMIUM_RATE = 0.0016;
  const VILLA_COST_PER_M2 = 90000;

  const propertyTypeSelect = document.getElementById('propertyType');
  const propertyValueGroup = document.getElementById('propertyValueGroup');
  const propertyValueInput = document.getElementById('propertyValue');
  const surfaceInput = document.getElementById('surface');
  const contentsInput = document.getElementById('contentsValue');

  const structureValueDisplay = document.getElementById('structureValueDisplay');
  const contentsValueDisplay = document.getElementById('contentsValueDisplay');
  const surfaceDisplay = document.getElementById('surfaceDisplay');
  const pricePerM2Display = document.getElementById('pricePerM2Display');
  const totalValueDisplay = document.getElementById('totalValueDisplay');
  const premiumDisplay = document.getElementById('premiumDisplay');
  const premium20Display = document.getElementById('premium20Display');
  const premium30Display = document.getElementById('premium30Display');

  const typeHelp = document.getElementById('typeHelp');
  const surfaceHelp = document.getElementById('surfaceHelp');

  function parseNumber(str) {
    if (!str) return 0;
    str = String(str)
      .replace(/\s+/g, '')
      .replace(/,/g, '')   // presje si ndarës mijëshe
      .replace(/\./g, '.'); // pika si dhjetore
    const val = parseFloat(str);
    return isNaN(val) ? 0 : val;
  }

  // Shfaq numrat me presje si ndarës mijëshe
  function formatLek(num, decimals = 0) {
    if (num === null || num === undefined || isNaN(num)) return '-';
    const fixed = Number(num).toFixed(decimals);   // p.sh. "1234567.89"
    const parts = fixed.split('.');
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ','); // 1,234,567
    return parts.join(decimals > 0 ? '.' : '');
  }

  function updateUIForType() {
    const type = propertyTypeSelect.value;

    if (type === 'apartament') {
      propertyValueGroup.style.display = 'block';
      typeHelp.innerHTML =
        "Apartament – vlera totale deklarohet nga klienti.<br>" +
        "Vilë – vlera e strukturës llogaritet me koston 90 000 lek/m².";
      surfaceHelp.textContent =
        "Përdoret për të llogaritur çmimin për m² mbi vlerën e deklaruar.";
    } else {
      propertyValueGroup.style.display = 'none';
      typeHelp.innerHTML =
        "Vilë – vlera e strukturës llogaritet automatikisht me 90 000 lek/m².";
      surfaceHelp.textContent =
        "Përdoret për të llogaritur vlerën e vilës: 90 000 lek × m² dhe çmimin për m².";
    }

    calculate();
  }

  function resetDisplays(structure, contents, surface, pricePerM2, total, premium, p20, p30) {
    structureValueDisplay.textContent = structure;
    contentsValueDisplay.textContent = contents;
    surfaceDisplay.textContent = surface;
    pricePerM2Display.textContent = pricePerM2;
    totalValueDisplay.textContent = total;
    premiumDisplay.textContent = premium;
    premium20Display.textContent = p20;
    premium30Display.textContent = p30;
  }

  function calculate() {
    const type = propertyTypeSelect.value;
    const surface = parseNumber(surfaceInput.value);
    const contentsVal = parseNumber(contentsInput.value);
    const declaredValue = parseNumber(propertyValueInput.value);

    let structureValue = 0;
    let pricePerM2 = 0;

    if (type === 'apartament') {
      if (!surface || !declaredValue) {
        resetDisplays(
          declaredValue ? formatLek(declaredValue) : '-',
          contentsVal ? formatLek(contentsVal) : '-',
          surface ? formatLek(surface, 2) : '-',
          '-',
          '-',
          '-',
          '-',
          '-'
        );
        return;
      }
      structureValue = declaredValue;
      pricePerM2 = declaredValue / surface;
    } else if (type === 'vile') {
      if (!surface) {
        resetDisplays(
          '-',
          contentsVal ? formatLek(contentsVal) : '-',
          '-',
          '-',
          '-',
          '-',
          '-',
          '-'
        );
        return;
      }
      structureValue = surface * VILLA_COST_PER_M2;
      pricePerM2 = VILLA_COST_PER_M2;
    }

    const totalValue = structureValue + contentsVal;
    const premium = totalValue * PREMIUM_RATE;
    const premium20 = premium * 0.8; // 20% zbritje
    const premium30 = premium * 0.7; // 30% zbritje

    resetDisplays(
      formatLek(structureValue),
      contentsVal ? formatLek(contentsVal) : '0',
      surface ? formatLek(surface, 2) : '-',
      pricePerM2 ? formatLek(pricePerM2, type === 'apartament' ? 2 : 0) : '-',
      formatLek(totalValue),
      formatLek(premium, 2),
      formatLek(premium20, 2),
      formatLek(premium30, 2)
    );
  }

  propertyTypeSelect.addEventListener('change', updateUIForType);
  surfaceInput.addEventListener('input', calculate);
  contentsInput.addEventListener('input', calculate);
  propertyValueInput.addEventListener('input', calculate);

  // Init
  updateUIForType();
</script>
</body>
</html>
